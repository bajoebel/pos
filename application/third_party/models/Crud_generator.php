<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class Crud_generator extends CI_Controller
{
    public $dbname='db_coba';
    function __construct()
    {
        parent::__construct();
        $this->load->model('Generator_model');
        $this->load->library('form_validation');
    }

    public function index()
    {
        $table_name = urldecode($this->input->get('tabel', TRUE));
        if(!empty($table_name)){
            $data = array(
                'daftar_tabel'  => $this->Generator_model->daftar_tabel($this->dbname),
                'page'          => urldecode($this->input->get('tabel', TRUE)),
                'daftar_column' => $this->Generator_model->daftar_column($this->dbname, $table_name),
            );
            $data['content']= $this->load->view('generator/generator_content',$data,true);
            $this->load->view('generator/generator_template',$data);
        }else{
            $pesan="<div class=\"callout callout-success\">
              <h4><i class=\"icon fa fa-thumbs-up\"></i> Welcome</h4>
              <p>Selamat Datang Di CRUD Generator <br><marquee>Build Your System</marquee></p>
            </div>";
            $data = array(
                'daftar_tabel'  => $this->Generator_model->daftar_tabel($this->dbname),
                'page'          => urldecode($this->input->get('tabel', TRUE)),
                'content'       => $pesan,
            );
            $this->load->view('generator/generator_template',$data);
        }
        
    }

    public function add(){
        $table_name = urldecode($this->input->get('tabel', TRUE));
        $pesan="
        <div class=\"callout callout-warning\">
            <h4><i class=\"icon fa fa-thumbs-up\"></i> Warning</h4>
            <p>Belum Ada Content</p>
        </div>";

        $data = array(
            'daftar_tabel'  => $this->Generator_model->daftar_tabel($this->dbname),
            'page'          => 'Add',
            'content'       => $pesan,
        );
        $data['content']=$this->load->view('generator/generator_add',$data,TRUE);
        $this->load->view('generator/generator_template',$data);
    }

    public function pagination(){
        $string_pagination = "<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/* 
* Pagination Config Bootstrap 3 CSS Style
*/
\$config['query_string_segment'] = 'start';

\$config['full_tag_open'] = '<nav><ul class=\"pagination\" style=\"margin-top:0px\">';
\$config['full_tag_close'] = '</ul></nav>';

\$config['first_link'] = 'First';
\$config['first_tag_open'] = '<li>';
\$config['first_tag_close'] = '</li>';

\$config['last_link'] = 'Last';
\$config['last_tag_open'] = '<li>';
\$config['last_tag_close'] = '</li>';

\$config['next_link'] = 'Next';
\$config['next_tag_open'] = '<li>';
\$config['next_tag_close'] = '</li>';

\$config['prev_link'] = 'Prev';
\$config['prev_tag_open'] = '<li>';
\$config['prev_tag_close'] = '</li>';

\$config['cur_tag_open'] = '<li class=\"active\"><a>';
\$config['cur_tag_close'] = '</a></li>';

\$config['num_tag_open'] = '<li>';
\$config['num_tag_close'] = '</li>';


/* End of file pagination.php */
/* Location: ./application/config/pagination.php */
/* Please DO NOT modify this information : */
/* Generated by CRUD Generator V 1.0 ".date('Y-m-d H:i:s')." */
/* Copyright @ 2017 By Wanhar Azri S.Kom */";
        return $string_pagination;
    }

    public function proses(){
        $this->load->helper('file');
        $controller_name =ucwords($this->input->post('controller_name'));
        $models_name=ucwords($this->input->post('models_name'));
        $view_list=$this->input->post('view_list');
        $view_form=$this->input->post('view_form');
        $view_read=$this->input->post('view_read');
        $view_report=$this->input->post('view_report');
        $val=$this->input->post('type');

        if($this->input->post('add')=='Y') $add='Y'; else $add='N';
        if($this->input->post('update')=='Y') $update='Y'; else $update='N';
        if($this->input->post('delete')=='Y') $delete='Y'; else $delete='N';
        if($this->input->post('report')=='Y') $report='Y'; else $report='N';
        if($this->input->post('read')=='Y') $read='Y'; else $read='N';
        if($this->input->post('search')=='Y') $search='Y'; else $search='N';

        if($this->input->post('auth')=='Y') $auth='Y'; else $auth='N';
        if($this->input->post('create_auth')=='Y') $create_auth='Y'; else $create_auth='N';

        $control=$this->input->post('control');
        $view=$this->input->post('view');
        $source=$this->input->post('source');
        $field=$this->input->post('field');

        $jml_field=count($field);

        $table_name=$this->input->post('table_name');
        $field_key=$this->input->post('key');
        $string_pagination=$this->pagination();
        $string_controller="";
        $string_models="";
        $string_view_list="";
        $string_view_form="";
        $string_view_read="";
        $string_view_report="";
/*Buat Config Paginasi*/


$string_controller.="<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class " .$controller_name ." extends CI_Controller
{
    function __construct()
    {
        parent::__construct();
        \$this->load->model('$models_name');
        \$this->load->model('m_general');
        \$this->load->library('form_validation');
    }

    public function index()
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
    $string_controller.="
        \$q = urldecode(\$this->input->get('q', TRUE));
        \$start = intval(\$this->input->get('start'));
        
        if (\$q <> '') {
            \$config['base_url'] = base_url() . '" .$controller_name ."/index.html?q=' . urlencode(\$q);
            \$config['first_url'] = base_url() . '" .$controller_name ."/index.html?q=' . urlencode(\$q);
        } else {
            \$config['base_url'] = base_url() . '" .$controller_name ."/index.html';
            \$config['first_url'] = base_url() . '" .$controller_name ."/index.html';
        }

        \$config['per_page'] = 10;
        \$config['page_query_string'] = TRUE;
        \$config['total_rows'] = \$this->" .$models_name ."->total_rows(\$q);
        \$$controller_name" ."_data" ." = \$this->" .$models_name ."->get_limit_data(\$config['per_page'], \$start, \$q);

        \$this->load->library('pagination');
        \$this->pagination->initialize(\$config);

        \$data = array(";

        $string_controller.="
            '" .$controller_name ."_data' => \$$controller_name" ."_data" .",
            'q' => \$q,
            'pagination' => \$this->pagination->create_links(),
            'total_rows' => \$config['total_rows'],
            'start' => \$start,";
            if ($auth=='Y') {
            $string_controller.="
            'menu'=>\$auth['menu'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
            }
            $string_controller.="
        );

        \$content=array(";
        if($auth=='Y'){
        $string_controller.="
            'priv_count'=>\$auth['priv_count'],";
        }
        else{
            $string_controller.="
            'priv_count'=>1,";
        }
        $string_controller.="
            'title' => 'List " .ucwords(str_replace("_"," ",$controller_name)) ."',
            'isi' => \$this->load->view('" .$controller_name ."/$view_list', \$data,true)
        );
        \$x['content']=\$this->load->view('template_form',\$content,true);
        \$this->load->view('template',\$x);
    }";
    if($read=='Y'){
    $string_controller.="
    public function read(\$id) 
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
    $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);
        if (\$row) {
            \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                $string_controller .="
                '$field[$i]' => \$row->" .$field[$i] .",";
                }
                if ($auth=='Y') {
                $string_controller.="
                'menu'=>\$auth['menu'],
                'username'=>\$auth['username'],
                'id_group'=>\$auth['id_group'],
                'add'=>\$auth['add'],
                'update'=>\$auth['update'],
                'delete'=>\$auth['delete'],
                'report'=>\$auth['report'],";
                }
                $string_controller.="
            );

            \$content=array(";
            if($auth=='Y'){
            $string_controller.="
                'priv_count'=>\$auth['priv_count'],";
            }else{
                $string_controller.="
                'priv_count'=>1,";
            }
            $string_controller.="
                'title' => 'List " .ucwords(str_replace("_"," ",$controller_name)) ."',
                'isi' => \$this->load->view('" .$controller_name ."/$view_read', \$data,true)
            );
            \$x['content']=\$this->load->view('template_form',\$content,true);
            \$this->load->view('template',\$x);
        } else {
            \$this->session->set_flashdata('message', 'Record Not Found');
            redirect(site_url('" .$controller_name ."'));
        }
    }";
    }
    if($add=='Y'){
    $string_controller.="
    public function add() 
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
        
        $string_controller.="
        \$data = array(";
        if ($auth=='Y') {
        $string_controller.="
            'menu'=>\$auth['menu'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
        }else{
            $string_controller.="
            'menu'=>\$this->m_general->menu(\$this->session->userdata('user_akses_level')),";
        }
        $string_controller.="
            'button' => 'Add',
            'action' => site_url('" .$controller_name ."/add_action'),";
            for ($i=0; $i < $jml_field; $i++) { 
            $string_controller .="
            '$field[$i]' => set_value('$field[$i]'),";
                if ($control[$i]=='combobox' && $source[$i] != "-") {
                    $string_controller.="
            'list_" .$source[$i] ."'=>\$this->" .$models_name ."->get_" .$source[$i] ."(),";
                }
            }
        $string_controller.="
        );
        
        \$content=array(";
        if($auth=='Y'){
        $string_controller.="
            'priv_count'=>\$auth['priv_count'],";
        }else{
            $string_controller.="
            'priv_count'=>1,";
        }
        $string_controller.="
            'title' => 'Add " .ucwords(str_replace("_"," ",$controller_name)) ."',
            'isi' => \$this->load->view('" .$controller_name ."/$view_form', \$data,true)
        );
        \$x['content']=\$this->load->view('template_form',\$content,true);
        \$this->load->view('template',\$x);
    }
    
    public function add_action() 
    {";
    if ($auth=='Y') {
        $string_controller.="
        \$auth=\$this->_header();";

        $string_controller.="
        if(\$auth['add']=='Y'){
        \$this->_rules();
            if (\$this->form_validation->run() == FALSE) {
                \$this->add()();
            } else {";
            for( $i=0; $i<$jml_field; $i++){
                if ($control[$i]=='checkbox') {
                    $str=$val[$i];
                    $str1=str_replace("enum('",'',$str);
                    $str2=str_replace("')",'',$str1);
                    $str3=str_replace("'",'',$str2);
                    $str4=explode(',', $str3);
                    $enum_count=count($str4);
                    $ecc=0;
                    foreach ($str4 as $s) {
                        $ecc++;
                        if ($ecc==1) {
                            if ($s=="tinyint(1)") {
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                            }else{
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }    
                        }else{
                            if ($ecc==$enum_count) {
                            $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                            }else{
                            $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }
                        }
                        
                    }

                }
            }
                $string_controller.="
                \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
                    $string_controller.="
                    '$field[$i]' => \$" .$field[$i] .",";
                }else{
                    if($field_key!=$field[$i]){
                        $string_controller .="
                    '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                    
                }
            
            }
            $string_controller.="
                );

                \$this->" .$models_name ."->insert(\$data);
                \$this->session->set_flashdata('message', 'Create Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
            \$this->session->set_flashdata('message', 'You Dont have permision to accses this page');
            redirect(site_url('" .$controller_name ."'));
        }";
    }else{
        $string_controller.="
        \$this->_rules();
        if (\$this->form_validation->run() == FALSE) {
            \$this->add();
        } else {";
        for( $i=0; $i<$jml_field; $i++){
                if ($control[$i]=='checkbox') {
                    $str=$val[$i];
                    $str1=str_replace("enum('",'',$str);
                    $str2=str_replace("')",'',$str1);
                    $str3=str_replace("'",'',$str2);
                    $str4=explode(',', $str3);
                    $enum_count=count($str4);
                    $ecc=0;
                    foreach ($str4 as $s) {
                        $ecc++;
                        if ($ecc==1) {
                            if ($s=="tinyint(1)") {
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                            }else{
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }    
                        }else{
                            if ($ecc==$enum_count) {
                            $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                            }else{
                            $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }
                        }
                        
                    }

                }
        }
            $string_controller.="
            \$data = array(";
            for ($i=0; $i < $jml_field; $i++) { 
                if ($control[$i]=='checkbox') {
                $string_controller.="
                '$field[$i]' => \$" .$field[$i] .",";
            }else{
                if($field_key!=$field[$i]){
                    $string_controller .="
                '$field[$i]' => \$this->input->post('$field[$i]'),";
                }
            }
            
        }
        $string_controller.="
            );
                \$this->" .$models_name ."->insert(\$data);
                \$this->session->set_flashdata('message', 'Create Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        ";    
    }
        $string_controller.="
    }";
    
    }

    if($update=='Y'){
    $string_controller.="
    public function update(\$id) 
    {";
        if ($auth=='Y') {
        $string_controller.="
        \$auth=\$this->_header();";
        }
        $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);

        if (\$row) {
            \$data = array(";
            if($auth=='Y'){
            $string_controller.="
                'menu'=>\$auth['menu'],
                'username'=>\$auth['username'],
                'id_group'=>\$auth['id_group'],
                'add'=>\$auth['add'],
                'update'=>\$auth['update'],
                'delete'=>\$auth['delete'],
                'report'=>\$auth['report'],";
            }else{
                $string_controller.="
                \$x['menu']=\$this->m_general->menu(\$this->session->userdata('user_akses_level')),";
            }
            $string_controller.="
                'button' => 'Update',
                'action' => site_url('" .$controller_name ."/update_action'),";
                for ($i=0; $i < $jml_field; $i++) { 
                $string_controller .="
                '$field[$i]' => set_value('$field[$i]', \$row->$field[$i]),";
                    if ($control[$i]=='combobox' && $source[$i] != "-") {
            $string_controller.="
                'list_" .$source[$i] ."'=>\$this->" .$models_name ."->get_" .$source[$i] ."(),";
                    }
                }
            $string_controller.="
            );

            \$content=array(";
            if($auth=='Y'){
            $string_controller.="
                'priv_count'=>\$auth['priv_count'],";
            }else{
                $string_controller.="
                'priv_count'=>1,";
            }
            $string_controller.="
                'title' => 'Update " .ucwords(str_replace("_"," ",$controller_name)) ."',
                'isi' => \$this->load->view('" .$controller_name ."/$view_form', \$data,true)
            );
            \$x['content']=\$this->load->view('template_form',\$content,true);
            \$this->load->view('template',\$x);
        } else {
            \$this->session->set_flashdata('message', 'Record Not Found');
            redirect(site_url('" .$controller_name ."'));
        }
    }
    
    public function update_action() 
    {";
    if($auth=='Y'){
        $string_controller.="
        \$auth=\$this->_header();
        if(\$auth['update']=='Y'){
            \$this->_rules();

            if (\$this->form_validation->run() == FALSE) {
                \$this->update(\$this->input->post('id_kategori_job', TRUE));
            } else {";
        for( $i=0; $i<$jml_field; $i++){
        if ($control[$i]=='checkbox') {
            $str=$val[$i];
            $str1=str_replace("enum('",'',$str);
            $str2=str_replace("')",'',$str1);
            $str3=str_replace("'",'',$str2);
            $str4=explode(',', $str3);
            $enum_count=count($str4);
            $ecu=0;
            foreach ($str4 as $s) {
                $ecu++;
                if ($ecu==1) {
                    if ($s=="tinyint(1)") {
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                    }else{
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }    
                }else{
                    if ($ecu==$enum_count) {
                    $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                    }else{
                    $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }
                }
                
            }

        }
        }
            $string_controller.="
                \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
            $string_controller.="
                    '$field[$i]' => \$" .$field[$i] .",";
                    }else{
            $string_controller .="
                    '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                }
                $string_controller.="
                );

                \$this->" .$models_name ."->update(\$this->input->post('$field_key', TRUE), \$data);
                \$this->session->set_flashdata('message', 'Update Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
            \$this->session->set_flashdata('message', 'You Dont have permision to update this record');
            redirect(site_url('" .$controller_name ."'));
        }";
    }else{
        $string_controller.="
        
        \$this->_rules();

        if (\$this->form_validation->run() == FALSE) {
            \$this->update(\$this->input->post('id_kategori_job', TRUE));
        } else {";
        for( $i=0; $i<$jml_field; $i++){
        if ($control[$i]=='checkbox') {
            $str=$val[$i];
            $str1=str_replace("enum('",'',$str);
            $str2=str_replace("')",'',$str1);
            $str3=str_replace("'",'',$str2);
            $str4=explode(',', $str3);
            $enum_count=count($str4);
            $ecu=0;
            foreach ($str4 as $s) {
                $ecu++;
                if ($ecu==1) {
                    if ($s=="tinyint(1)") {
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                    }else{
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }    
                }else{
                    if ($ecu==$enum_count) {
                    $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                    }else{
                    $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }
                }
                
            }
        }
        }
            $string_controller.="
            \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
            $string_controller.="
                '$field[$i]' => \$" .$field[$i] .",";
                    }else{
            $string_controller .="
                '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                }
                $string_controller.="
            );

            \$this->" .$models_name ."->update(\$this->input->post('$field_key', TRUE), \$data);
            \$this->session->set_flashdata('message', 'Update Record Success');
            redirect(site_url('" .$controller_name ."'));
        }
        ";
    }
        $string_controller.="
    }";

    }

    if($delete=='Y'){
    $string_controller.="
    public function delete(\$id) 
    {";
    if($auth=='Y'){
    $string_controller.="
        \$auth=\$this->_header();";
    }
    $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);
        if(\$auth['delete']=='Y'){
            if (\$row) {
                \$this->" .$models_name ."->delete(\$id);
                \$this->session->set_flashdata('message', 'Delete Record Success');
                redirect(site_url('" .$controller_name ."'));
            } else {
                \$this->session->set_flashdata('message', 'Record Not Found');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
        \$this->session->set_flashdata('message', 'You Dont have permision to delete this record');
            redirect(site_url('" .$controller_name ."'));
        }   
    }";
    }
    $string_controller.="
    public function _rules() 
    {";

    for ($i=0; $i < $jml_field; $i++) { 
        if($control[$i]=='hidden' || $control[$i]=='checkbox' || $control[$i]=='file'){
        $string_controller .="
        \$this->form_validation->set_rules('$field[$i]', '$field[$i]', 'trim');";
        }else{
           $string_controller .="
        \$this->form_validation->set_rules('$field[$i]', '$field[$i]', 'trim|required');"; 
        }
    }
        $string_controller.="
        \$this->form_validation->set_error_delimiters('<span class=\"text-danger\">', '</span>');
    }";
    if($report=='Y'){
    $string_controller.="
    public function report()
    {";
    if($auth=='Y'){
    $string_controller.="
        \$auth=\$this->_header();";
    }
        $string_controller.="
        \$$controller_name" ."_data" ." = \$this->" .$models_name ."->get_all();

        \$data = array(";

        $string_controller.="
            '" .$controller_name ."_data' => \$$controller_name" ."_data" .",
            'start' => 0,
            'menu'=>\$auth['menu'],";
            if($auth=='Y'){
            $string_controller.="
            'priv_count'=>\$auth['priv_count'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
            }
            $string_controller.="
        );
        \$x['content']=\$this->load->view('" .$controller_name ."/$view_report', \$data);
        //\$this->load->view('template',\$x);
    }";
    }
    $string_controller.="
    public function _header(){
        \$x['menu']=\$this->m_general->menu(\$this->session->userdata('user_akses_level'));
        \$x['username']=\$this->session->userdata('username');

        \$x['id_group']=\$this->session->userdata('user_akses_level');
        \$priv=\$this->m_general->get_privilage(\$x['id_group'],'" .$controller_name ."');
        \$x['priv_count']=\$this->m_general->cek_privilage(\$x['id_group'],'" .$controller_name ."');
        \$x['add']='N';
        \$x['update']='N';
        \$x['delete']='N';
        \$x['report']='N';
        foreach (\$priv as \$a) {
        \$x['add']=\$a['add1'];
        \$x['update']=\$a['update1'];
        \$x['delete']=\$a['delete1'];
        \$x['report']=\$a['report1'];
        }
        return \$x;
    }
}

/* End of file " .$controller_name .".php */
/* Location: ./application/controllers/" .$controller_name .".php */
/* Please DO NOT modify this information : */
/* Generated by Codeigniter CRUD Generator V 1.0 " .date('d M Y h:i:s') ."*/
/* Copyright @ 2017 By Wanhar Azri S.Kom */";

$string_models.="<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class " .$models_name ." extends CI_Model
{

    public \$table = '$table_name';
    public \$id = '$field_key';
    public \$order = 'DESC';

    function __construct()
    {
        parent::__construct();
    }

    // get all
    function get_all()
    {
        \$this->db->order_by(\$this->id, \$this->order);
        return \$this->db->get(\$this->table)->result();
    }

    // get data by id
    function get_by_id(\$id)
    {
        \$this->db->where(\$this->id, \$id);
        return \$this->db->get(\$this->table)->row();
    }
    
    // get total rows
    function total_rows(\$q = NULL) {";
    $idx=0;
    foreach ($view as $v) {
        if($idx==0){
        $string_models.="
        \$this->db->like('$v', \$q);";
        }else{
        $string_models.="
        \$this->db->or_like('$v', \$q);";         
        }
        $idx++;
    }
        $string_models.="
        \$this->db->from(\$this->table);
        return \$this->db->count_all_results();
    }

    // get data with limit and search
    function get_limit_data(\$limit, \$start = 0, \$q = NULL) {
        \$this->db->order_by(\$this->id, \$this->order);";
    $idx1=0;
    foreach ($view as $v) {
        if($idx1==0){
        $string_models.="
        \$this->db->like('$v', \$q);";
        }else{
        $string_models.="
        \$this->db->or_like('$v', \$q);";         
        }
        $idx1++;
    }
        $string_models .="
        \$this->db->limit(\$limit, \$start);
        return \$this->db->get(\$this->table)->result();
    }

    // insert data
    function insert(\$data)
    {
        \$this->db->insert(\$this->table, \$data);
    }

    // update data
    function update(\$id, \$data)
    {
        \$this->db->where(\$this->id, \$id);
        \$this->db->update(\$this->table, \$data);
    }

    // delete data
    function delete(\$id)
    {
        \$this->db->where(\$this->id, \$id);
        \$this->db->delete(\$this->table);
    }";

    foreach ($source as $s) {
        if($s!="-"){
        $string_models.="
    function get_" .$s ."()
    {
        return \$this->db->get('" .$s ."')->result();
    }";  
        }
    
    }
    $string_models.="
}

/* End of file " .$models_name .".php */
/* Location: ./application/models/" .$models_name .".php */
/* Please DO NOT modify this information : */
/* Generated by Codeigniter CRUD Generator V1 " .date('d M Y h:i:s') ." */
/* Copyright @ 2017 By Wanhar Azri S.Kom */";


$string_view_list.="
<div class=\"col-sm-12 col-xs-12\" style=\"margin-bottom: 10px\">
    <div class=\"col-md-4\">";
    if ($add=='Y') {
        if($auth=='Y'){
        $string_view_list.="
        <?php 
        if(!empty(\$add)) {
            if(\$add=='Y'){
                echo anchor(site_url('" .$controller_name ."/add'),'<span class=\"fa fa-plus-circle\"></span> Add', 'class=\"btn btn-primary \"'); 
            }
        }
        ?>";
        }else{
        $string_view_list.="
        <?php 
            echo anchor(site_url('" .$controller_name ."/add'),'<span class=\"fa fa-plus-circle\"></span> Add', 'class=\"btn btn-primary\"'); 
        ?>";  
        }
    }
    $string_view_list.="
    </div>
    
    <div class=\"col-md-4 text-center\">
        <div style=\"margin-top: 8px\" id=\"message\">
            <?php echo \$this->session->userdata('message') <> '' ? \$this->session->userdata('message') : ''; ?>
        </div>
    </div>
    
    <div class=\"col-md-1 text-right\"></div>
    <div class=\"col-md-3 text-right\">";
        if ($search=='Y') {
        $string_view_list.="
        <form action=\"<?php echo site_url('$controller_name/index'); ?>\" class=\"form-inline\" method=\"get\">
            <div class=\"input-group\">
                <input type=\"text\" class=\"form-control\" name=\"q\" value=\"<?php echo \$q; ?>\">
                <span class=\"input-group-btn\">
                    <?php 
                    if (\$q <> '')
                    {
                    ?>
                    <a href=\"<?php echo site_url('$controller_name'); ?>\" class=\"btn btn-default\">Reset</a>
                    <?php
                    }
                    ?>
                    <button class=\"btn btn-primary\" type=\"submit\">Search</button>
                </span>
            </div>
        </form>";   
        }
        $string_view_list.="
    </div>

    <div class=\"col-sm-12 col-xs-12\" style=\"overflow-x:auto;\">
        <table class=\"table table-bordered\" style=\"margin-bottom: 10px\">
        <tr>
            <th>No</th>";
            foreach ($view as $v) {
            $string_view_list .="
            <th>" .ucwords(str_replace("_"," ",$v)) ."</th>";
            }
            $string_view_list.="
            <th>Action</th>
        </tr>
        <?php
        foreach (\$" .$controller_name ."_data as \$" .$controller_name .")
        {
        ?>
        <tr>
            <td width=\"80px\"><?php echo ++\$start ?></td>";
            foreach ($view as $v) {
            $string_view_list .="
            <td><?php echo \$" .$controller_name ."->" .$v ." ?></td>";
            }
            $string_view_list.="
            <td style=\"text-align:center\" width=\"200px\">
            <?php ";
            if($read=='Y'){
            $string_view_list.="
                echo anchor(site_url('" .$controller_name ."/read/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-success btn-xs glyphicon glyphicon-search\"></span>');";
            }
            if ($update=='Y') {
                if($auth=='Y'){
            $string_view_list.="
            if(!empty(\$update)) {
                if(\$update=='Y'){
            echo ' | '; 
            echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); 
                    }
                }";
                }else{
            $string_view_list.="
            echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); ";
                }
            }
                if ($delete=='Y') {
                    if($auth=='Y'){
                $string_view_list.="
                if(!empty(\$delete)) {
                    if(\$delete=='Y'){
            echo ' | '; 
            echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');
                    } 
                }";
                    }else{
                $string_view_list.="
            echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');";
                    }
                }
                $string_view_list.="
                ?>
                </td>
            </tr>
            <?php
            }
            ?>
        </table>
        <div class=\"row\">";
            
            $string_view_list .="
            <div class=\"col-md-6\">
                <a href=\"#\" class=\"btn btn-default\">Total Record : <?php echo \$total_rows ?></a>";
                if($report=='Y'){
                    if($auth=='Y'){
                $string_view_list.="
                <?php 
                if(!empty(\$report)) {
                    if(\$report=='Y'){ 
                        echo anchor(site_url('$controller_name/report'), 'Report', 'class=\"btn btn-success\"'); 
                    } 
                }
                ?>";
                    }else{
                       $string_view_list.="
                <?php
                    echo anchor(site_url('$controller_name/report'), 'Report', 'class=\"btn btn-success\"'); 
                ?>"; 

                    }
                }
                $string_view_list.="    
            </div>

            <div class=\"col-md-6 text-right\">
                <?php echo \$pagination ?>
            </div>";
            $string_view_list .= "
        </div>
    </div>
</div>";

$string_view_form.="
<form action=\"<?php echo \$action; ?>\" method=\"post\"> ";
    for ($i=0; $i < $jml_field; $i++) { 
        if($control[$i]=='text'){
        $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"text\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='password') {
    $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"password\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='datepicker') {
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <div class=\"input-group date\">
                    <div class=\"input-group-addon\">
            <i class=\"fa fa-calendar\"></i>
                    </div>
                    <input type=\"text\" name='" .$field[$i] ."' class=\"form-control pull-right\" id=\"datepicker\" value=\"<?php echo \$" .$field[$i] ."; ?>\" >
                </div>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='textarea') {
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <textarea class=\"form-control ckeditor\" rows=\"3\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\"><?php echo \$" .$field[$i] ."; ?></textarea>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='combobox') {
    $str=$val[$i];
    $str1=str_replace("enum('",'',$str);
    $str2=str_replace("')",'',$str1);
    $str3=str_replace("'",'',$str2);
    $str4=explode(',', $str3);
    $enum_count=count($str4);
    $list_field=$this->Generator_model->daftar_column($this->dbname, $source[$i]);
    //echo "ID " .$list_field->COLUMN_NAME ." Isi : " .$list_field->COLUMN_KEY; 
    $idx=0;
    foreach ($list_field as $l) {
        $idx++;
        if($l->COLUMN_KEY=='PRI') {
            $source_id= $l->COLUMN_NAME;
            $source_view=$l->COLUMN_NAME;
        }
        else {
            if ($idx==2) {
                $source_view= $l->COLUMN_NAME;
            }
        }
    }
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <select class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ." \" placeholder='" .ucwords(str_replace("_"," ",$field[$i])) ."'>";
                    if ($source[$i]!='-') {
                        $string_view_form .= "
                    <?php 
                    foreach (\$list_" .$source[$i] ." as \$list) {";
                    $string_view_form.="
                    ?>
                    <option value='<?php echo \$list->" .$source_id ."; ?>' <?php if (\$list->" .$source_id ."==\$" .$field[$i] .") echo 'selected'; ?>><?php echo \$list->" .$source_view ."; ?></option>
                    <?php
                    }
                    ?>
                    ";
                    }else{
                        foreach ($str4 as $s) {
                        $string_view_form.="
                        <option value='" .$s ."' <?php if($" .$field[$i] ."==\"" .$s ."\") echo \"selected\" ?>>" .$s ."</option>";
                        }
                    }
                    
                $string_view_form.="
                </select>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='checkbox') {
    $str=$val[$i];
    $str1=str_replace("enum('",'',$str);
    $str2=str_replace("')",'',$str1);
    $str3=str_replace("'",'',$str2);
    $str4=explode(',', $str3);
    $enum_count=count($str4);
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">&nbsp;</label>
            </div>
            <div class=\"col-md-9\">";
            if ($str4[0]=='tinyint(1)') $str4[0]=1; else $str[0]=0;
            $string_view_form.= "
                <input type=\"checkbox\" name=\"" .$field[$i] ."\" value=\"" .$str4[0] ."\" <?php if($" .$field[$i] ."==\"" .$str4[0] ."\") echo \"checked\"; ?>/>".ucwords(str_replace("_"," ",$field[$i]));
            $string_view_form.="
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='radio') {
    $str=$val[$i];
    $str1=str_replace("enum('",'',$str);
    $str2=str_replace("')",'',$str1);
    $str3=str_replace("'",'',$str2);
    $str4=explode(',', $str3);
    $enum_count=count($str4);
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">";
            foreach ($str4 as $r) {
            $string_view_form.="
                <input type=\"radio\" name=\"" .$field[$i] ."\" value=\"" .$r ."\" <?php if($" .$field[$i] ."==\"" .$r ."\") echo \"checked\"; ?> > " .$r ;
            }
            $string_view_form.="
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }elseif ($control[$i]=='file') {
    $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"file\" name=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
    }
    elseif ($control[$i]=='hidden') {
    $string_view_form.="
    <input type=\"hidden\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />";
    }
    }
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">&nbsp;</div>
            <div class=\"col-md-9 pull-right\">    
                <button type=\"submit\" class=\"btn btn-primary\">
                    <?php echo \$button ?>
                </button> 
                <a href=\"<?php echo site_url('" .$controller_name ."') ?>\" class=\"btn btn-default\">Cancel</a>
            </div>
        </div>
    </div>
</form>
";

$string_view_read.="
<div class=\"col-sm-12 col-xs-12\" style=\"overflow-x:auto;\">
    <table class=\"table\">";
        for ($i=0; $i < $jml_field; $i++) { 
        $string_view_read .="
        <tr>
            <td>" .ucwords(str_replace("_"," ",$field[$i])) ."</td>
            <td><?php echo \$" .$field[$i] ."; ?></td>
            </tr>";
            }
            $string_view_read.="
        <tr>
            <td></td>
            <td>
                <a href=\"<?php echo site_url('" .$controller_name ."') ?>\" class=\"btn btn-default\">Cancel</a>
            </td>
        </tr>
    </table>
</div>";

$string_view_report.="
<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
<html xmlns=\"http://www.w3.org/1999/xhtml\">
<head>

<style type=\"text/css\">
td{
    padding:0px 0px 10px 0px;
    font-size:16px;
}
</style>
<script>  
    function cetak(){  
        print();  
    }  
  
    function PrintPreview() {
        var toPrint = document.getElementById('printarea');
        var popupWin = window.open('', '_blank', 'width=350,height=150,location=no,left=200px');
        popupWin.document.open();
        popupWin.document.write('<html><title>::Print Preview::</title><link rel=\"stylesheet\" type=\"text/css\" href=\"Print.css\" media=\"screen\"/></head><body\">')
        popupWin.document.write(toPrint.innerHTML);
        popupWin.document.write('</html>');
        popupWin.document.close();

    }
</script>
<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />
<title>Laporan " .$controller_name ."</title>

<body onload=\"cetak()\">
    <div style=\"width:800px; margin:0 auto;  \">
        <div style=\"height:1200px\">
            <div style=\"width:700px; margin:0 auto;  \">
                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">
                    <tr>";
                    foreach ($field as $v) {
                    $string_view_report .="
                    <th>" .ucwords(str_replace("_"," ",$v)) ."</th>";
                    }
                    $string_view_report.=
                    "</tr>
                    <?php
                    foreach (\$" .$controller_name ."_data as \$" .$controller_name .")
                    {
                    ?>
                    <tr>
                        <td width=\"80px\"><?php echo ++\$start ?></td>";
                        foreach ($view as $v) {
                        $string_view_report .="
                        <td><?php echo \$" .$controller_name ."->" .$v ." ?></td>";
                        }
                        $string_view_report.="
                        <td style=\"text-align:center\" width=\"200px\">
                        <?php ";
                        if($read=='Y'){
                        $string_view_report.="
                        echo anchor(site_url('" .$controller_name ."/read/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-success btn-xs glyphicon glyphicon-search\"></span>');";
                        }
                        if ($update=='Y') {
                        $string_view_report.="
                        if(!empty(\$update)) {
                            if(\$update=='Y'){
                                echo ' | '; 
                                echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); 
                                }
                            }";
                        }
                        if ($delete=='Y') {
                        $string_view_report.="
                        if(!empty(\$delete)) {
                            if(\$delete=='Y'){
                                echo ' | '; 
                                echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');
                            } 
                        }";
                        }
                        $string_view_report.="
                        ?>
                        </td>
                    </tr>
                    <?php
                    }
                    ?>
                </table>
            </div>
        </div>
    </div>

</body>
</html>
";
        if($create_auth=='Y'){
            /*Create Database*/
            $sql_group="CREATE TABLE IF NOT EXISTS `tbl_group` (
              `group_id` int(11) NOT NULL AUTO_INCREMENT,
              `group_name` varchar(50) NOT NULL DEFAULT '',
              `status` enum('Active','Non Active') NOT NULL DEFAULT 'Active',
              `admin` enum('Y','N') NOT NULL DEFAULT 'Y',
              `info1` varchar(50) NOT NULL DEFAULT '',
              `info2` varchar(50) NOT NULL,
              PRIMARY KEY (`group_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_moduls="CREATE TABLE IF NOT EXISTS `tbl_moduls` (
              `moduls_id` int(11) NOT NULL AUTO_INCREMENT,
              `moduls_title` varchar(50) NOT NULL DEFAULT '',
              `moduls_url` varchar(50) NOT NULL DEFAULT '',
              `moduls_parent_idx` int(11) NOT NULL,
              `moduls_child_idx` int(11) NOT NULL,
              `moduls_status` enum('Active','Non Active') NOT NULL DEFAULT 'Active',
              `info1` varchar(50) NOT NULL DEFAULT '',
              `info2` varchar(50) NOT NULL,
              PRIMARY KEY (`moduls_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_moduls_group="CREATE TABLE IF NOT EXISTS `tbl_moduls_group` (
              `moduls_group_id` int(11) NOT NULL AUTO_INCREMENT,
              `moduls_id` int(11) NOT NULL,
              `group_id` int(11) NOT NULL,
              `add1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `update1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `delete1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `report1` enum('Y','N') NOT NULL DEFAULT 'Y',
              PRIMARY KEY (`moduls_group_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_users="CREATE TABLE IF NOT EXISTS `tbl_users` (
              `username` char(32) NOT NULL,
              `user_password` char(32) NOT NULL DEFAULT '',
              `user_nama_lengkap` varchar(50) NOT NULL DEFAULT '',
              `user_jekel` enum('Laki-Laki','Perempuan') NOT NULL,
              `user_alamat`  varchar(100) NOT NULL,
              `user_email`  varchar(100) NOT NULL DEFAULT '',
              `user_kontak`  varchar(15) NOT NULL DEFAULT '',
              `user_status` enum('Aktif','Tidak Aktif') NOT NULL DEFAULT 'Tidak Aktif',
              `user_photo` varchar(15) NOT NULL DEFAULT '',
              `admin` enum('Y','N') NOT NULL DEFAULT 'Y',
              `user_group_id` int(11) NOT NULL,
              PRIMARY KEY (`username`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            if($this->db->query($sql_group)) $pesan['tbl_group']='Table tbl_group Berhasil dibuat';
            else $pesan['tbl_group']='Table tbl_group Berhasil dibuat';

            if($this->db->query($sql_moduls)) $pesan['tbl_moduls']='Table tbl_moduls Berhasil dibuat';
            else $pesan['tbl_moduls']='Table tbl_moduls Berhasil dibuat';

            if($this->db->query($sql_moduls_group)) $pesan['sql_moduls_group']='Table sql_moduls_group Berhasil dibuat';
            else $pesan['sql_moduls_group']='Table sql_moduls_group Berhasil dibuat';

            if($this->db->query($sql_users)) $pesan['sql_users']='Table sql_users Berhasil dibuat';
            else $pesan['sql_users']='Table sql_users Berhasil dibuat';

            /*$this->db->query("INSERT INTO tbl_group ('group_name','status'.'admin','info1','info2') VALUES('Adminstrtor','Active','Y','','')");
            $this->db->query("INSERT INTO tbl_moduls ('moduls_title','moduls_url','moduls_parent_idx','moduls_child_idx','modul_status','info1','info2') VALUES ('Moduls','#',100,0,'Active','','')");
            $this->db->query("INSERT INTO tbl_moduls ('moduls_title','moduls_url','moduls_parent_idx','moduls_child_idx','modul_status','info1','info2') VALUES ('Group','group',100,1,'Active','','')");
            $this->db->query("INSERT INTO tbl_moduls ('moduls_title','moduls_url','moduls_parent_idx','moduls_child_idx','modul_status','info1','info2') VALUES ('Group','group',100,1,'Active','','')");*/
            $controll_auth=$this->Generator_model->code_auth_controller();
            $models_general=$this->Generator_model->code_m_general();
            $view_login=$this->Generator_model->code_view_login();

            //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Auth.php', $controll_auth))
            {
                $pesan['controller_auth']= 'File ./application/controllers/Auth.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_auth']= 'File ./application/controllers/Auth.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/M_general.php', $models_general))
            {
                $pesan['m_general']= 'File ./application/views/m_general.php Gagal dibuat';
            }
            else
            {
                $pesan['m_general']= 'File ./application/models/M_general.php Berhasil dibuat';
            }

            //Membuat View List
            if ( ! write_file('./application/views/view_login.php', $view_login)){
                $pesan['view_login']= 'File ./application/views/view_login.php gagal dibuat';
            }
            else{
                $pesan['view_login']= 'File ./application/views/view_login.php berhasil dibuat';
            }

            $group_controller=$this->Generator_model->code_group_controller();
            $group_models=$this->Generator_model->code_group_models();
            $view_group_form=$this->Generator_model->code_group_form();
            $view_group_list=$this->Generator_model->code_group_form();
            $view_group_read=$this->Generator_model->code_group_form();
            $view_group_report=$this->Generator_model->code_group_form();
            $view_group_form=$this->Generator_model->code_group_form();
            $view_group_form=$this->Generator_model->code_group_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Group.php', $group_controller))
            {
                $pesan['controller_group']= 'File ./application/controllers/Group.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_group']= 'File ./application/controllers/Group.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Group_model.php', $group_models))
            {
                $pesan['models_group']= 'File ./application/models/Group_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_group']= 'File ./application/models/Group_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/Group';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Group Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Group/group_list.php', $view_group_list)){
                $pesan['view_group_list']= 'File ./application/views/Group/group_list.php gagal dibuat';
            }
            else{
                $pesan['view_group_list']= 'File ./application/views/Group/group_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Group/group_form.php', $view_group_form)){
                $pesan['view_group_form']= 'File ./application/views/Group/group_form.php gagal dibuat';
            }
            else{
                $pesan['view_group_form']= 'File ./application/views/Group/group_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Group/group_read.php', $view_group_read)){
                $pesan['view_group_read']= 'File ./application/views/Group/group_read.php gagal dibuat';
            }
            else{
                $pesan['view_group_read']= 'File ./application/views/Group/group_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Group/group_report.php', $view_group_report)){
                $pesan['view_group_report']= 'File ./application/views/Group/group_report.php gagal dibuat';
            }
            else{
                $pesan['view_group_report']= 'File ./application/views/Group/group_report.php berhasil dibuat';
            }


            $moduls_controller=$this->Generator_model->code_moduls_controller();
            $moduls_models=$this->Generator_model->code_moduls_models();
            $view_moduls_form=$this->Generator_model->code_moduls_form();
            $view_moduls_list=$this->Generator_model->code_moduls_form();
            $view_moduls_read=$this->Generator_model->code_moduls_form();
            $view_moduls_report=$this->Generator_model->code_moduls_form();
            $view_moduls_form=$this->Generator_model->code_moduls_form();
            $view_moduls_form=$this->Generator_model->code_moduls_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Moduls.php', $moduls_controller))
            {
                $pesan['controller_moduls']= 'File ./application/controllers/Moduls.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_moduls']= 'File ./application/controllers/Moduls.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Moduls_model.php', $moduls_models))
            {
                $pesan['models_moduls']= 'File ./application/models/Moduls_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_moduls']= 'File ./application/models/Moduls_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/moduls';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Moduls Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Moduls/moduls_list.php', $view_moduls_list)){
                $pesan['view_moduls_list']= 'File ./application/views/Moduls/moduls_list.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_list']= 'File ./application/views/Moduls/moduls_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Moduls/moduls_form.php', $view_moduls_form)){
                $pesan['view_moduls_form']= 'File ./application/views/Moduls/moduls_form.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_form']= 'File ./application/views/Moduls/moduls_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Moduls/moduls_read.php', $view_moduls_read)){
                $pesan['view_moduls_read']= 'File ./application/views/Moduls/moduls_read.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_read']= 'File ./application/views/Moduls/moduls_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Moduls/moduls_report.php', $view_moduls_report)){
                $pesan['view_moduls_report']= 'File ./application/views/Moduls/moduls_report.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_report']= 'File ./application/views/Moduls/moduls_report.php berhasil dibuat';
            }


            $users_controller=$this->Generator_model->code_users_controller();
            $users_models=$this->Generator_model->code_users_models();
            $view_users_form=$this->Generator_model->code_users_form();
            $view_users_list=$this->Generator_model->code_users_form();
            $view_users_read=$this->Generator_model->code_users_form();
            $view_users_report=$this->Generator_model->code_users_form();
            $view_users_form=$this->Generator_model->code_users_form();
            $view_users_form=$this->Generator_model->code_users_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Users.php', $users_controller))
            {
                $pesan['controller_users']= 'File ./application/controllers/Users.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_users']= 'File ./application/controllers/Users.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Users_model.php', $users_models))
            {
                $pesan['models_users']= 'File ./application/models/Users_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_users']= 'File ./application/models/Users_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/Users';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Users Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Users/users_list.php', $view_users_list)){
                $pesan['view_users_list']= 'File ./application/views/Users/users_list.php gagal dibuat';
            }
            else{
                $pesan['view_users_list']= 'File ./application/views/Users/users_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Users/users_form.php', $view_users_form)){
                $pesan['view_users_form']= 'File ./application/views/Users/users_form.php gagal dibuat';
            }
            else{
                $pesan['view_users_form']= 'File ./application/views/Users/users_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Users/users_read.php', $view_users_read)){
                $pesan['view_users_read']= 'File ./application/views/Users/users_read.php gagal dibuat';
            }
            else{
                $pesan['view_users_read']= 'File ./application/views/Users/users_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Users/users_report.php', $view_users_report)){
                $pesan['view_users_report']= 'File ./application/views/Users/users_report.php gagal dibuat';
            }
            else{
                $pesan['view_users_report']= 'File ./application/views/Users/users_report.php berhasil dibuat';
            }
        }
        //Membuat File config/pagination.php
        if ( ! write_file('./application/config/pagination.php', $string_pagination)){
            $error['paginasi']= 'File ./application/config/pagination.php Gagal Dibuat';
        }else
        {
            $pesan['paginasi']= 'File ./application/config/pagination.php Berhasil Dibuat';
        }

        //Membuat File controller/nama_controller.php
        if ( ! write_file('./application/controllers/' .$controller_name .'.php', $string_controller))
        {
            $error['controller']= 'File ./application/controllers/' .$controller_name .'.php Gagal Dibuat';
        }
        else
        {
            $pesan['controller']= 'File ./application/controllers/' .$controller_name .'.php berhasil dibuat';
        }

        //Membuat File models/nama_models.php
        if ( ! write_file('./application/models/' .$models_name .'.php', $string_models))
        {
            $error['models']= 'File ./application/models/' .$models_name .'.php Gagal dibuat';
        }
        else
        {
            $pesan['models']= 'File ./application/models/' .$models_name .'.php Berhasil dibuat';
        }
        //Membuat FOlder do view
        $path='application/views/' .$controller_name;
        if(!is_dir($path)) //create the folder if it's not already exists
        {
            mkdir($path,0755,TRUE);
            $pesan['path']= "Folder ./application/views/$controller_name Berhasil dibuat";
        }else{
            $error['path']= "Gagal Membuat folder ./application/views/$controller_name ";
        }

        //Membuat View List
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_list .'.php', $string_view_list)){
            $error['view_list']= 'File ./application/views/' .$view_list .'.php gagal dibuat';
        }
        else{
            $pesan['view_list']= 'File ./application/views/' .$view_list .'.php berhasil dibuat';
        }

        //Membuat View Form
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_form .'.php', $string_view_form)){
            $error['view_form']= 'File ./application/views/' .$view_form .'.php gagal dibuat';
        }
        else{
            $pesan['view_form']= 'File ./application/views/' .$view_form .'.php berhasil dibuat';
        }

        //Membuat View Read
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_read .'.php', $string_view_read)){
            $error['view_read']= 'File ./application/views/' .$view_read .'.php gagal dibuat';
        }
        else{
            $pesan['view_read']= 'File ./application/views/' .$view_read .'.php berhasil dibuat';
        }
        
        //Membuat View Report
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_report .'.php', $string_view_report)){
            $error['view_report']= 'File ./application/views/' .$view_report .'.php gagal dibuat';
        }
        else{
            $pesan['view_report']= 'File ./application/views/' .$view_report .'.php berhasil dibuat';
        }

        $this->session->set_flashdata('error', $error);
        $this->session->set_flashdata('message', $pesan);
        redirect(site_url('crud_generator/index?tabel=' .$table_name));
    }

    public function create_test(){
        $field=$this->input->post('field_system');
        $type=$this->input->post('type_system');
        $size=$this->input->post('size_system');

        $jml_field=count($field);
        if($this)
        $table_name=$this->input->post('surfix') .$this->input->post('table_name');
        $sql_form="CREATE TABLE IF NOT EXISTS `" .$table_name ."` (";
        
        $i=0;
        foreach ($field as $f) {
            if($i==0){
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] .") " .$this->input->post('key') ." " .$this->input->post('auto') .",";
            }else{
                if($i==$jml_field){
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] .")";
                }else{
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] ."),";   
                }
            }
            $i++;
        }
        $sql_form.="
        ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

        echo $sql_form;
    }

    public function create_form(){
        $this->load->helper('file');
        $controller_name =ucwords($this->input->post('table_name'));
        $models_name=ucwords($this->input->post('table_name')) ."_model";
        $view_list="view_" .$this->input->post('table_name') ."_list";
        $view_form="view_" .$this->input->post('table_name') ."_form";
        $view_read="view_" .$this->input->post('table_name') ."_read";
        $view_report="view_" .$this->input->post('table_name') ."_read";
        $val=$this->input->post('type');

        if($this->input->post('add')=='Y') $add='Y'; else $add='N';
        if($this->input->post('update')=='Y') $update='Y'; else $update='N';
        if($this->input->post('delete')=='Y') $delete='Y'; else $delete='N';
        if($this->input->post('report')=='Y') $report='Y'; else $report='N';
        if($this->input->post('read')=='Y') $read='Y'; else $read='N';
        if($this->input->post('search')=='Y') $search='Y'; else $search='N';

        if($this->input->post('auth')=='Y') $auth='Y'; else $auth='N';
        if($this->input->post('create_auth')=='Y') $create_auth='Y'; else $create_auth='N';

        $control=$this->input->post('control_system');
        $view=$this->input->post('field_system');
        $source=$this->input->post('source_system');
        $field=$this->input->post('field_system');

        $jml_field=count($field);

        $table_name=$this->input->post('surfix') .$this->input->post('table_name');
        
        $string_pagination=$this->pagination();
        $string_controller="";
        $string_models="";
        $string_view_list="";
        $string_view_form="";
        $string_view_read="";
        $string_view_report="";
/*Buat Config Paginasi*/
        $field=$this->input->post('field_system');
        $field_key=$field[0];
        $type=$this->input->post('type_system');
        $size=$this->input->post('size_system');

        $jml_field=count($field);
        $table_name=$this->input->post('surfix') .$this->input->post('table_name');
        $sql_form="CREATE TABLE IF NOT EXISTS `" .$table_name ."` (";
        
        $i=0;
        foreach ($field as $f) {
            if($i==0){
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] .") " .$this->input->post('key') ." " .$this->input->post('auto') .",";
            }else{
                if($i==$jml_field-1){
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] .")";
                }else{
                $sql_form.="
                `" .$f ."` " .$type[$i] ."(" .$size[$i] ."),";   
                }
            }
            $i++;
        }
        $sql_form.="
        ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

        $this->db->query($sql_form);

$string_controller.="<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class " .$controller_name ." extends CI_Controller
{
    function __construct()
    {
        parent::__construct();
        \$this->load->model('$models_name');
        \$this->load->model('m_general');
        \$this->load->library('form_validation');
    }

    public function index()
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
    $string_controller.="
        \$q = urldecode(\$this->input->get('q', TRUE));
        \$start = intval(\$this->input->get('start'));
        
        if (\$q <> '') {
            \$config['base_url'] = base_url() . '" .$controller_name ."/index.html?q=' . urlencode(\$q);
            \$config['first_url'] = base_url() . '" .$controller_name ."/index.html?q=' . urlencode(\$q);
        } else {
            \$config['base_url'] = base_url() . '" .$controller_name ."/index.html';
            \$config['first_url'] = base_url() . '" .$controller_name ."/index.html';
        }

        \$config['per_page'] = 10;
        \$config['page_query_string'] = TRUE;
        \$config['total_rows'] = \$this->" .$models_name ."->total_rows(\$q);
        \$$controller_name" ."_data" ." = \$this->" .$models_name ."->get_limit_data(\$config['per_page'], \$start, \$q);

        \$this->load->library('pagination');
        \$this->pagination->initialize(\$config);

        \$data = array(";

        $string_controller.="
            '" .$controller_name ."_data' => \$$controller_name" ."_data" .",
            'q' => \$q,
            'pagination' => \$this->pagination->create_links(),
            'total_rows' => \$config['total_rows'],
            'start' => \$start,";
            if ($auth=='Y') {
            $string_controller.="
            'menu'=>\$auth['menu'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
            }
            $string_controller.="
        );

        \$content=array(";
        if($auth=='Y'){
        $string_controller.="
            'priv_count'=>\$auth['priv_count'],";
        }
        else{
            $string_controller.="
            'priv_count'=>1,";
        }
        $string_controller.="
            'title' => 'List " .ucwords(str_replace("_"," ",$controller_name)) ."',
            'isi' => \$this->load->view('" .$controller_name ."/$view_list', \$data,true)
        );
        \$x['content']=\$this->load->view('template_form',\$content,true);
        \$this->load->view('template',\$x);
    }";
    if($read=='Y'){
    $string_controller.="
    public function read(\$id) 
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
    $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);
        if (\$row) {
            \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                $string_controller .="
                '$field[$i]' => \$row->" .$field[$i] .",";
                }
                if ($auth=='Y') {
                $string_controller.="
                'menu'=>\$auth['menu'],
                'username'=>\$auth['username'],
                'id_group'=>\$auth['id_group'],
                'add'=>\$auth['add'],
                'update'=>\$auth['update'],
                'delete'=>\$auth['delete'],
                'report'=>\$auth['report'],";
                }
                $string_controller.="
            );

            \$content=array(";
            if($auth=='Y'){
            $string_controller.="
                'priv_count'=>\$auth['priv_count'],";
            }else{
                $string_controller.="
                'priv_count'=>1,";
            }
            $string_controller.="
                'title' => 'List " .ucwords(str_replace("_"," ",$controller_name)) ."',
                'isi' => \$this->load->view('" .$controller_name ."/$view_read', \$data,true)
            );
            \$x['content']=\$this->load->view('template_form',\$content,true);
            \$this->load->view('template',\$x);
        } else {
            \$this->session->set_flashdata('message', 'Record Not Found');
            redirect(site_url('" .$controller_name ."'));
        }
    }";
    }
    if($add=='Y'){
    $string_controller.="
    public function add() 
    {";
    if ($auth=='Y') {
    $string_controller.="
        \$auth=\$this->_header();";
    }
        
        $string_controller.="
        \$data = array(";
        if ($auth=='Y') {
        $string_controller.="
            'menu'=>\$auth['menu'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
        }else{
            $string_controller.="
            'menu'=>\$this->m_general->menu(\$this->session->userdata('user_akses_level')),";
        }
        $string_controller.="
            'button' => 'Add',
            'action' => site_url('" .$controller_name ."/add_action'),";
            for ($i=0; $i < $jml_field; $i++) { 
            $string_controller .="
            '$field[$i]' => set_value('$field[$i]'),";
                if ($control[$i]=='combobox' && $source[$i] != "-") {
                    $string_controller.="
            'list_" .$source[$i] ."'=>\$this->" .$models_name ."->get_" .$source[$i] ."(),";
                }
            }
        $string_controller.="
        );
        
        \$content=array(";
        if($auth=='Y'){
        $string_controller.="
            'priv_count'=>\$auth['priv_count'],";
        }else{
            $string_controller.="
            'priv_count'=>1,";
        }
        $string_controller.="
            'title' => 'Add " .ucwords(str_replace("_"," ",$controller_name)) ."',
            'isi' => \$this->load->view('" .$controller_name ."/$view_form', \$data,true)
        );
        \$x['content']=\$this->load->view('template_form',\$content,true);
        \$this->load->view('template',\$x);
    }
    
    public function add_action() 
    {";
    if ($auth=='Y') {
        $string_controller.="
        \$auth=\$this->_header();";

        $string_controller.="
        if(\$auth['add']=='Y'){
        \$this->_rules();
            if (\$this->form_validation->run() == FALSE) {
                \$this->add();
            } else {";
            for( $i=0; $i<$jml_field; $i++){
                if ($control[$i]=='checkbox') {
                    $str=$val[$i];
                    $str1=str_replace("enum('",'',$str);
                    $str2=str_replace("')",'',$str1);
                    $str3=str_replace("'",'',$str2);
                    $str4=explode(',', $str3);
                    $enum_count=count($str4);
                    $ecc=0;
                    foreach ($str4 as $s) {
                        $ecc++;
                        if ($ecc==1) {
                            if ($s=="tinyint(1)") {
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                            }else{
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }    
                        }else{
                            if ($ecc==$enum_count) {
                            $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                            }else{
                            $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }
                        }
                        
                    }

                }
            }
                $string_controller.="
                \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
                    $string_controller.="
                    '$field[$i]' => \$" .$field[$i] .",";
                }else{
                    if($field_key!=$field[$i]){
                        $string_controller .="
                    '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                    
                }
            
            }
            $string_controller.="
                );

                \$this->" .$models_name ."->insert(\$data);
                \$this->session->set_flashdata('message', 'Create Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
            \$this->session->set_flashdata('message', 'You Dont have permision to accses this page');
            redirect(site_url('" .$controller_name ."'));
        }";
    }else{
        $string_controller.="
        \$this->_rules();
        if (\$this->form_validation->run() == FALSE) {
            \$this->add();
        } else {";
        for( $i=0; $i<$jml_field; $i++){
                if ($control[$i]=='checkbox') {
                    $str=$val[$i];
                    $str1=str_replace("enum('",'',$str);
                    $str2=str_replace("')",'',$str1);
                    $str3=str_replace("'",'',$str2);
                    $str4=explode(',', $str3);
                    $enum_count=count($str4);
                    $ecc=0;
                    foreach ($str4 as $s) {
                        $ecc++;
                        if ($ecc==1) {
                            if ($s=="tinyint(1)") {
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                            }else{
                            $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }    
                        }else{
                            if ($ecc==$enum_count) {
                            $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                            }else{
                            $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                            }
                        }
                        
                    }

                }
        }
            $string_controller.="
            \$data = array(";
            for ($i=0; $i < $jml_field; $i++) { 
                if ($control[$i]=='checkbox') {
                $string_controller.="
                '$field[$i]' => \$" .$field[$i] .",";
            }else{
                if($field_key!=$field[$i]){
                    $string_controller .="
                '$field[$i]' => \$this->input->post('$field[$i]'),";
                }
            }
            
        }
        $string_controller.="
            );
                \$this->" .$models_name ."->insert(\$data);
                \$this->session->set_flashdata('message', 'Create Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        ";    
    }
        $string_controller.="
    }";
    
    }

    if($update=='Y'){
    $string_controller.="
    public function update(\$id) 
    {";
        if ($auth=='Y') {
        $string_controller.="
        \$auth=\$this->_header();";
        }
        $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);

        if (\$row) {
            \$data = array(";
            if($auth=='Y'){
            $string_controller.="
                'menu'=>\$auth['menu'],
                'username'=>\$auth['username'],
                'id_group'=>\$auth['id_group'],
                'add'=>\$auth['add'],
                'update'=>\$auth['update'],
                'delete'=>\$auth['delete'],
                'report'=>\$auth['report'],";
            }else{
                $string_controller.="
                \$x['menu']=\$this->m_general->menu(\$this->session->userdata('user_akses_level')),";
            }
            $string_controller.="
                'button' => 'Update',
                'action' => site_url('" .$controller_name ."/update_action'),";
                for ($i=0; $i < $jml_field; $i++) { 
                $string_controller .="
                '$field[$i]' => set_value('$field[$i]', \$row->$field[$i]),";
                    if ($control[$i]=='combobox' && $source[$i] != "-") {
            $string_controller.="
                'list_" .$source[$i] ."'=>\$this->" .$models_name ."->get_" .$source[$i] ."(),";
                    }
                }
            $string_controller.="
            );

            \$content=array(";
            if($auth=='Y'){
            $string_controller.="
                'priv_count'=>\$auth['priv_count'],";
            }else{
                $string_controller.="
                'priv_count'=>1,";
            }
            $string_controller.="
                'title' => 'Update " .ucwords(str_replace("_"," ",$controller_name)) ."',
                'isi' => \$this->load->view('" .$controller_name ."/$view_form', \$data,true)
            );
            \$x['content']=\$this->load->view('template_form',\$content,true);
            \$this->load->view('template',\$x);
        } else {
            \$this->session->set_flashdata('message', 'Record Not Found');
            redirect(site_url('" .$controller_name ."'));
        }
    }
    
    public function update_action() 
    {";
    if($auth=='Y'){
        $string_controller.="
        \$auth=\$this->_header();
        if(\$auth['update']=='Y'){
            \$this->_rules();

            if (\$this->form_validation->run() == FALSE) {
                \$this->update(\$this->input->post('id_kategori_job', TRUE));
            } else {";
        for( $i=0; $i<$jml_field; $i++){
        if ($control[$i]=='checkbox') {
            $str=$val[$i];
            $str1=str_replace("enum('",'',$str);
            $str2=str_replace("')",'',$str1);
            $str3=str_replace("'",'',$str2);
            $str4=explode(',', $str3);
            $enum_count=count($str4);
            $ecu=0;
            foreach ($str4 as $s) {
                $ecu++;
                if ($ecu==1) {
                    if ($s=="tinyint(1)") {
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                    }else{
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }    
                }else{
                    if ($ecu==$enum_count) {
                    $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                    }else{
                    $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }
                }
                
            }

        }
        }
            $string_controller.="
                \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
            $string_controller.="
                    '$field[$i]' => \$" .$field[$i] .",";
                    }else{
            $string_controller .="
                    '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                }
                $string_controller.="
                );

                \$this->" .$models_name ."->update(\$this->input->post('$field_key', TRUE), \$data);
                \$this->session->set_flashdata('message', 'Update Record Success');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
            \$this->session->set_flashdata('message', 'You Dont have permision to update this record');
            redirect(site_url('" .$controller_name ."'));
        }";
    }else{
        $string_controller.="
        
        \$this->_rules();

        if (\$this->form_validation->run() == FALSE) {
            \$this->update(\$this->input->post('id_kategori_job', TRUE));
        } else {";
        for( $i=0; $i<$jml_field; $i++){
        if ($control[$i]=='checkbox') {
            $str=$val[$i];
            $str1=str_replace("enum('",'',$str);
            $str2=str_replace("')",'',$str1);
            $str3=str_replace("'",'',$str2);
            $str4=explode(',', $str3);
            $enum_count=count($str4);
            $ecu=0;
            foreach ($str4 as $s) {
                $ecu++;
                if ($ecu==1) {
                    if ($s=="tinyint(1)") {
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')==1) \$" .$field[$i] ."=1; else \$" .$field[$i] ."=0;";
                    }else{
                    $string_controller.="
                if(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }    
                }else{
                    if ($ecu==$enum_count) {
                    $string_controller.="
                else \$" .$field[$i] ."='" .$s ."';";
                    }else{
                    $string_controller.="
                elseif(\$this->input->post('" .$field[$i] ."')=='" .$s ."') \$" .$field[$i] ."='" .$s ."';";
                    }
                }
                
            }
        }
        }
            $string_controller.="
            \$data = array(";
                for ($i=0; $i < $jml_field; $i++) { 
                    if ($control[$i]=='checkbox') {
            $string_controller.="
                '$field[$i]' => \$" .$field[$i] .",";
                    }else{
            $string_controller .="
                '$field[$i]' => \$this->input->post('$field[$i]'),";
                    }
                }
                $string_controller.="
            );

            \$this->" .$models_name ."->update(\$this->input->post('$field_key', TRUE), \$data);
            \$this->session->set_flashdata('message', 'Update Record Success');
            redirect(site_url('" .$controller_name ."'));
        }
        ";
    }
        $string_controller.="
    }";

    }

    if($delete=='Y'){
    $string_controller.="
    public function delete(\$id) 
    {";
    if($auth=='Y'){
    $string_controller.="
        \$auth=\$this->_header();";
    $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);
        if(\$auth['delete']=='Y'){
            if (\$row) {
                \$this->" .$models_name ."->delete(\$id);
                \$this->session->set_flashdata('message', 'Delete Record Success');
                redirect(site_url('" .$controller_name ."'));
            } else {
                \$this->session->set_flashdata('message', 'Record Not Found');
                redirect(site_url('" .$controller_name ."'));
            }
        }else{
            \$this->session->set_flashdata('message', 'You Dont have permision to delete this record');
            redirect(site_url('" .$controller_name ."'));
        }";
    }else{
    $string_controller.="
        \$row = \$this->" .$models_name ."->get_by_id(\$id);
        if (\$row) {
            \$this->" .$models_name ."->delete(\$id);
            \$this->session->set_flashdata('message', 'Delete Record Success');
            redirect(site_url('" .$controller_name ."'));
        } else {
            \$this->session->set_flashdata('message', 'Record Not Found');
            redirect(site_url('" .$controller_name ."'));
        }";
    }
    $string_controller.="
    }";
    $string_controller.="
    public function _rules() 
    {";

    for ($i=0; $i < $jml_field; $i++) { 
        if($control[$i]=='hidden' || $control[$i]=='checkbox' || $control[$i]=='file'){
        $string_controller .="
        \$this->form_validation->set_rules('$field[$i]', '$field[$i]', 'trim');";
        }else{
           $string_controller .="
        \$this->form_validation->set_rules('$field[$i]', '$field[$i]', 'trim|required');"; 
        }
    }
        $string_controller.="
        \$this->form_validation->set_error_delimiters('<span class=\"text-danger\">', '</span>');
    }";
    if($report=='Y'){
    $string_controller.="
    public function report()
    {";
    if($auth=='Y'){
    $string_controller.="
        \$auth=\$this->_header();";
    }
        $string_controller.="
        \$$controller_name" ."_data" ." = \$this->" .$models_name ."->get_all();

        \$data = array(";

        $string_controller.="
            '" .$controller_name ."_data' => \$$controller_name" ."_data" .",
            'start' => 0,";
            if($auth=='Y'){
            $string_controller.="
            'menu'=>\$auth['menu'],
            'priv_count'=>\$auth['priv_count'],
            'username'=>\$auth['username'],
            'id_group'=>\$auth['id_group'],
            'add'=>\$auth['add'],
            'update'=>\$auth['update'],
            'delete'=>\$auth['delete'],
            'report'=>\$auth['report'],";
            }
            $string_controller.="
        );
        \$x['content']=\$this->load->view('" .$controller_name ."/$view_report', \$data);
        //\$this->load->view('template',\$x);
    }";
    }
    $string_controller.="
    public function _header(){
        \$x['menu']=\$this->m_general->menu(\$this->session->userdata('user_akses_level'));
        \$x['username']=\$this->session->userdata('username');

        \$x['id_group']=\$this->session->userdata('user_akses_level');
        \$priv=\$this->m_general->get_privilage(\$x['id_group'],'" .$controller_name ."');
        \$x['priv_count']=\$this->m_general->cek_privilage(\$x['id_group'],'" .$controller_name ."');
        \$x['add']='N';
        \$x['update']='N';
        \$x['delete']='N';
        \$x['report']='N';
        foreach (\$priv as \$a) {
        \$x['add']=\$a['add1'];
        \$x['update']=\$a['update1'];
        \$x['delete']=\$a['delete1'];
        \$x['report']=\$a['report1'];
        }
        return \$x;
    }
}

/* End of file " .$controller_name .".php */
/* Location: ./application/controllers/" .$controller_name .".php */
/* Please DO NOT modify this information : */
/* Generated by Codeigniter CRUD Generator V 1.0 " .date('d M Y h:i:s') ."*/
/* Copyright @ 2017 By Wanhar Azri S.Kom */";

$string_models.="<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class " .$models_name ." extends CI_Model
{

    public \$table = '$table_name';
    public \$id = '$field_key';
    public \$order = 'DESC';

    function __construct()
    {
        parent::__construct();
    }

    // get all
    function get_all()
    {
        \$this->db->order_by(\$this->id, \$this->order);
        return \$this->db->get(\$this->table)->result();
    }

    // get data by id
    function get_by_id(\$id)
    {
        \$this->db->where(\$this->id, \$id);
        return \$this->db->get(\$this->table)->row();
    }
    
    // get total rows
    function total_rows(\$q = NULL) {";
    $idx=0;
    foreach ($view as $v) {
        if($idx==0){
        $string_models.="
        \$this->db->like('$v', \$q);";
        }else{
        $string_models.="
        \$this->db->or_like('$v', \$q);";         
        }
        $idx++;
    }
        $string_models.="
        \$this->db->from(\$this->table);
        return \$this->db->count_all_results();
    }

    // get data with limit and search
    function get_limit_data(\$limit, \$start = 0, \$q = NULL) {
        \$this->db->order_by(\$this->id, \$this->order);";
    $idx1=0;
    foreach ($view as $v) {
        if($idx1==0){
        $string_models.="
        \$this->db->like('$v', \$q);";
        }else{
        $string_models.="
        \$this->db->or_like('$v', \$q);";         
        }
        $idx1++;
    }
        $string_models .="
        \$this->db->limit(\$limit, \$start);
        return \$this->db->get(\$this->table)->result();
    }

    // insert data
    function insert(\$data)
    {
        \$this->db->insert(\$this->table, \$data);
    }

    // update data
    function update(\$id, \$data)
    {
        \$this->db->where(\$this->id, \$id);
        \$this->db->update(\$this->table, \$data);
    }

    // delete data
    function delete(\$id)
    {
        \$this->db->where(\$this->id, \$id);
        \$this->db->delete(\$this->table);
    }";

    foreach ($source as $s) {
        if($s!="-"){
        $string_models.="
    function get_" .$s ."()
    {
        return \$this->db->get('" .$s ."')->result();
    }";  
        }
    
    }
    $string_models.="
}

/* End of file " .$models_name .".php */
/* Location: ./application/models/" .$models_name .".php */
/* Please DO NOT modify this information : */
/* Generated by Codeigniter CRUD Generator V1 " .date('d M Y h:i:s') ." */
/* Copyright @ 2017 By Wanhar Azri S.Kom */";


$string_view_list.="
<div class=\"col-sm-12 col-xs-12\" style=\"margin-bottom: 10px\">
    <div class=\"col-md-4\">";
    if ($add=='Y') {
        if($auth=='Y'){
        $string_view_list.="
        <?php 
        if(!empty(\$add)) {
            if(\$add=='Y'){
                echo anchor(site_url('" .$controller_name ."/add'),'<span class=\"fa fa-plus-circle\"></span> Add', 'class=\"btn btn-primary \"'); 
            }
        }
        ?>";
        }else{
        $string_view_list.="
        <?php 
            echo anchor(site_url('" .$controller_name ."/add'),'<span class=\"fa fa-plus-circle\"></span> Add', 'class=\"btn btn-primary\"'); 
        ?>";  
        }
    }
    $string_view_list.="
    </div>
    
    <div class=\"col-md-4 text-center\">
        <div style=\"margin-top: 8px\" id=\"message\">
            <?php echo \$this->session->userdata('message') <> '' ? \$this->session->userdata('message') : ''; ?>
        </div>
    </div>
    
    <div class=\"col-md-1 text-right\"></div>
    <div class=\"col-md-3 text-right\">";
        if ($search=='Y') {
        $string_view_list.="
        <form action=\"<?php echo site_url('$controller_name/index'); ?>\" class=\"form-inline\" method=\"get\">
            <div class=\"input-group\">
                <input type=\"text\" class=\"form-control\" name=\"q\" value=\"<?php echo \$q; ?>\">
                <span class=\"input-group-btn\">
                    <?php 
                    if (\$q <> '')
                    {
                    ?>
                    <a href=\"<?php echo site_url('$controller_name'); ?>\" class=\"btn btn-default\">Reset</a>
                    <?php
                    }
                    ?>
                    <button class=\"btn btn-primary\" type=\"submit\">Search</button>
                </span>
            </div>
        </form>";   
        }
        $string_view_list.="
    </div>

    <div class=\"col-sm-12 col-xs-12\" style=\"overflow-x:auto;\">
        <table class=\"table table-bordered\" style=\"margin-bottom: 10px\">
        <tr>
            <th>No</th>";
            foreach ($view as $v) {
            $string_view_list .="
            <th>" .ucwords(str_replace("_"," ",$v)) ."</th>";
            }
            $string_view_list.="
            <th>Action</th>
        </tr>
        <?php
        foreach (\$" .$controller_name ."_data as \$" .$controller_name .")
        {
        ?>
        <tr>
            <td width=\"80px\"><?php echo ++\$start ?></td>";
            foreach ($view as $v) {
            $string_view_list .="
            <td><?php echo \$" .$controller_name ."->" .$v ." ?></td>";
            }
            $string_view_list.="
            <td style=\"text-align:center\" width=\"200px\">
            <?php ";
            if($read=='Y'){
            $string_view_list.="
                echo anchor(site_url('" .$controller_name ."/read/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-success btn-xs glyphicon glyphicon-search\"></span>');";
            }
            if ($update=='Y') {
                if($auth=='Y'){
            $string_view_list.="
            if(!empty(\$update)) {
                if(\$update=='Y'){
            echo ' | '; 
            echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); 
                    }
                }";
                }else{
            $string_view_list.="
            echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); ";
                }
            }
                if ($delete=='Y') {
                    if($auth=='Y'){
                $string_view_list.="
                if(!empty(\$delete)) {
                    if(\$delete=='Y'){
            echo ' | '; 
            echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');
                    } 
                }";
                    }else{
                $string_view_list.="
            echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');";
                    }
                }
                $string_view_list.="
                ?>
                </td>
            </tr>
            <?php
            }
            ?>
        </table>
        <div class=\"row\">";
            
            $string_view_list .="
            <div class=\"col-md-6\">
                <a href=\"#\" class=\"btn btn-default\">Total Record : <?php echo \$total_rows ?></a>";
                if($report=='Y'){
                    if($auth=='Y'){
                $string_view_list.="
                <?php 
                if(!empty(\$report)) {
                    if(\$report=='Y'){ 
                        echo anchor(site_url('$controller_name/report'), 'Report', 'class=\"btn btn-success\"'); 
                    } 
                }
                ?>";
                    }else{
                       $string_view_list.="
                <?php
                    echo anchor(site_url('$controller_name/report'), 'Report', 'class=\"btn btn-success\"'); 
                ?>"; 

                    }
                }
                $string_view_list.="    
            </div>

            <div class=\"col-md-6 text-right\">
                <?php echo \$pagination ?>
            </div>";
            $string_view_list .= "
        </div>
    </div>
</div>";

$string_view_form.="
<form action=\"<?php echo \$action; ?>\" method=\"post\"> ";
    for ($i=0; $i < $jml_field; $i++) { 
        if($control[$i]=='text'){
        $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"text\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='password') {
    $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"password\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='datepicker') {
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <div class=\"input-group date\">
                    <div class=\"input-group-addon\">
            <i class=\"fa fa-calendar\"></i>
                    </div>
                    <input type=\"text\" name='" .$field[$i] ."' class=\"form-control pull-right\" id=\"datepicker\" value=\"<?php echo \$" .$field[$i] ."; ?>\" >
                </div>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='textarea') {
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <textarea class=\"form-control ckeditor\" rows=\"3\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\"><?php echo \$" .$field[$i] ."; ?></textarea>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='combobox') {
        $str=$val[$i];
        $str1=str_replace("enum('",'',$str);
        $str2=str_replace("')",'',$str1);
        $str3=str_replace("'",'',$str2);
        $str4=explode(',', $str3);
        $enum_count=count($str4);
        $list_field=$this->Generator_model->daftar_column($this->dbname, $source[$i]);
        //echo "ID " .$list_field->COLUMN_NAME ." Isi : " .$list_field->COLUMN_KEY; 
        $idx=0;
        foreach ($list_field as $l) {
            $idx++;
            if($l->COLUMN_KEY=='PRI') {
                $source_id= $l->COLUMN_NAME;
                $source_view=$l->COLUMN_NAME;
            }
            else {
                if ($idx==2) {
                    $source_view= $l->COLUMN_NAME;
                }
            }
        }
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <select class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ." \" placeholder='" .ucwords(str_replace("_"," ",$field[$i])) ."'>";
                    if ($source[$i]!='-') {
                        $string_view_form .= "
                    <?php 
                    foreach (\$list_" .$source[$i] ." as \$list) {";
                    $string_view_form.="
                    ?>
                    <option value='<?php echo \$list->" .$source_id ."; ?>' <?php if (\$list->" .$source_id ."==\$" .$field[$i] .") echo 'selected'; ?>><?php echo \$list->" .$source_view ."; ?></option>
                    <?php
                    }
                    ?>
                    ";
                    }else{
                        foreach ($str4 as $s) {
                        $string_view_form.="
                        <option value='" .$s ."' <?php if($" .$field[$i] ."==\"" .$s ."\") echo \"selected\" ?>>" .$s ."</option>";
                        }
                    }
                    
                $string_view_form.="
                </select>
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='checkbox') {
        $str=$val[$i];
        $str1=str_replace("enum('",'',$str);
        $str2=str_replace("')",'',$str1);
        $str3=str_replace("'",'',$str2);
        $str4=explode(',', $str3);
        $enum_count=count($str4);
        $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">&nbsp;</label>
            </div>
            <div class=\"col-md-9\">";
            if ($str4[0]=='tinyint(1)') $str4[0]=1; else $str[0]=0;
            $string_view_form.= "
                <input type=\"checkbox\" name=\"" .$field[$i] ."\" value=\"" .$str4[0] ."\" <?php if($" .$field[$i] ."==\"" .$str4[0] ."\") echo \"checked\"; ?>/>".ucwords(str_replace("_"," ",$field[$i]));
            $string_view_form.="
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='radio') {
        $str=$val[$i];
        $str1=str_replace("enum('",'',$str);
        $str2=str_replace("')",'',$str1);
        $str3=str_replace("'",'',$str2);
        $str4=explode(',', $str3);
        $enum_count=count($str4);
        $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">";
            foreach ($str4 as $r) {
            $string_view_form.="
                <input type=\"radio\" name=\"" .$field[$i] ."\" value=\"" .$r ."\" <?php if($" .$field[$i] ."==\"" .$r ."\") echo \"checked\"; ?> > " .$r ;
            }
            $string_view_form.="
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }elseif ($control[$i]=='file') {
        $string_view_form .="
    <div class=\"col-md-12\">   
        <div class=\"form-group\">
            <div class=\"col-md-3\">
                <label for=\"varchar\">" .ucwords(str_replace("_"," ",$field[$i])) ."</label>
            </div>
            <div class=\"col-md-9\">
                <input type=\"file\" name=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" />
                <?php echo form_error('" .$field[$i] ."') ?>
            </div>
        </div>
    </div>";
        }
        elseif ($control[$i]=='hidden') {
        $string_view_form.="
    <input type=\"hidden\" class=\"form-control\" name=\"" .$field[$i] ."\" id=\"" .$field[$i] ."\" placeholder=\"" .ucwords(str_replace("_"," ",$field[$i])) ."\" value=\"<?php echo \$" .$field[$i] ."; ?>\" />";
        }
    }
    $string_view_form.="
    <div class=\"col-md-12\">
        <div class=\"form-group\">
            <div class=\"col-md-3\">&nbsp;</div>
            <div class=\"col-md-9 pull-right\">    
                <button type=\"submit\" class=\"btn btn-primary\">
                    <?php echo \$button ?>
                </button> 
                <a href=\"<?php echo site_url('" .$controller_name ."') ?>\" class=\"btn btn-default\">Cancel</a>
            </div>
        </div>
    </div>
</form>
";

$string_view_read.="
<div class=\"col-sm-12 col-xs-12\" style=\"overflow-x:auto;\">
    <table class=\"table\">";
        for ($i=0; $i < $jml_field; $i++) { 
        $string_view_read .="
        <tr>
            <td>" .ucwords(str_replace("_"," ",$field[$i])) ."</td>
            <td><?php echo \$" .$field[$i] ."; ?></td>
            </tr>";
        }
            $string_view_read.="
        <tr>
            <td></td>
            <td>
                <a href=\"<?php echo site_url('" .$controller_name ."') ?>\" class=\"btn btn-default\">Cancel</a>
            </td>
        </tr>
    </table>
</div>";

$string_view_report.="
<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
<html xmlns=\"http://www.w3.org/1999/xhtml\">
<head>

<style type=\"text/css\">
td{
    padding:0px 0px 10px 0px;
    font-size:16px;
}
</style>
<script>  
    function cetak(){  
        print();  
    }  
  
    function PrintPreview() {
        var toPrint = document.getElementById('printarea');
        var popupWin = window.open('', '_blank', 'width=350,height=150,location=no,left=200px');
        popupWin.document.open();
        popupWin.document.write('<html><title>::Print Preview::</title><link rel=\"stylesheet\" type=\"text/css\" href=\"Print.css\" media=\"screen\"/></head><body\">')
        popupWin.document.write(toPrint.innerHTML);
        popupWin.document.write('</html>');
        popupWin.document.close();

    }
</script>
<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />
<title>Laporan " .$controller_name ."</title>

<body onload=\"cetak()\">
    <div style=\"width:800px; margin:0 auto;  \">
        <div style=\"height:1200px\">
            <div style=\"width:700px; margin:0 auto;  \">
                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">
                    <tr>";
                    foreach ($field as $v) {
                    $string_view_report .="
                    <th>" .ucwords(str_replace("_"," ",$v)) ."</th>";
                    }
                    $string_view_report.=
                    "</tr>
                    <?php
                    foreach (\$" .$controller_name ."_data as \$" .$controller_name .")
                    {
                    ?>
                    <tr>
                        <td width=\"80px\"><?php echo ++\$start ?></td>";
                        foreach ($view as $v) {
                        $string_view_report .="
                        <td><?php echo \$" .$controller_name ."->" .$v ." ?></td>";
                        }
                        $string_view_report.="
                        <td style=\"text-align:center\" width=\"200px\">
                        <?php ";
                        if($read=='Y'){
                        $string_view_report.="
                        echo anchor(site_url('" .$controller_name ."/read/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-success btn-xs glyphicon glyphicon-search\"></span>');";
                        }
                        if ($update=='Y') {
                        $string_view_report.="
                        if(!empty(\$update)) {
                            if(\$update=='Y'){
                                echo ' | '; 
                                echo anchor(site_url('" .$controller_name ."/update/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-primary btn-xs glyphicon glyphicon-edit\"></span>'); 
                                }
                            }";
                        }
                        if ($delete=='Y') {
                        $string_view_report.="
                        if(!empty(\$delete)) {
                            if(\$delete=='Y'){
                                echo ' | '; 
                                echo anchor(site_url('" .$controller_name ."/delete/'.\$" .$controller_name ."->" .$field_key ."),'<span class=\"btn btn-danger btn-xs glyphicon glyphicon-remove-circle\"></span>','onclick=\"javasciprt: return confirm(\'Are You Sure ?\')\"');
                            } 
                        }";
                        }
                        $string_view_report.="
                        ?>
                        </td>
                    </tr>
                    <?php
                    }
                    ?>
                </table>
            </div>
        </div>
    </div>

</body>
</html>
";
        if($create_auth=='Y'){
            /*Create Database*/
            $sql_group="CREATE TABLE IF NOT EXISTS `tbl_group` (
              `group_id` int(11) NOT NULL AUTO_INCREMENT,
              `group_name` varchar(50) NOT NULL DEFAULT '',
              `status` enum('Active','Non Active') NOT NULL DEFAULT 'Active',
              `admin` enum('Y','N') NOT NULL DEFAULT 'Y',
              `info1` varchar(50) NOT NULL DEFAULT '',
              `info2` varchar(50) NOT NULL,
              PRIMARY KEY (`group_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_moduls="CREATE TABLE IF NOT EXISTS `tbl_moduls` (
              `moduls_id` int(11) NOT NULL AUTO_INCREMENT,
              `moduls_title` varchar(50) NOT NULL DEFAULT '',
              `moduls_url` varchar(50) NOT NULL DEFAULT '',
              `moduls_parent_idx` int(11) NOT NULL,
              `moduls_child_idx` int(11) NOT NULL,
              `moduls_status` enum('Active','Non Active') NOT NULL DEFAULT 'Active',
              `info1` varchar(50) NOT NULL DEFAULT '',
              `info2` varchar(50) NOT NULL,
              PRIMARY KEY (`moduls_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_moduls_group="CREATE TABLE IF NOT EXISTS `tbl_moduls_group` (
              `moduls_group_id` int(11) NOT NULL AUTO_INCREMENT,
              `moduls_id` int(11) NOT NULL,
              `group_id` int(11) NOT NULL,
              `add1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `update1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `delete1` enum('Y','N') NOT NULL DEFAULT 'Y',
              `report1` enum('Y','N') NOT NULL DEFAULT 'Y',
              PRIMARY KEY (`moduls_group_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            $sql_users="CREATE TABLE IF NOT EXISTS `tbl_users` (
              `username` char(32) NOT NULL,
              `user_password` char(32) NOT NULL DEFAULT '',
              `user_nama_lengkap` varchar(50) NOT NULL DEFAULT '',
              `user_jekel` enum('Laki-Laki','Perempuan') NOT NULL,
              `user_alamat`  varchar(100) NOT NULL,
              `user_email`  varchar(100) NOT NULL DEFAULT '',
              `user_kontak`  varchar(15) NOT NULL DEFAULT '',
              `user_status` enum('Aktif','Tidak Aktif') NOT NULL DEFAULT 'Tidak Aktif',
              `user_photo` varchar(15) NOT NULL DEFAULT '',
              `admin` enum('Y','N') NOT NULL DEFAULT 'Y',
              `user_group_id` int(11) NOT NULL,
              PRIMARY KEY (`username`)
            ) ENGINE=InnoDB DEFAULT CHARSET=latin1;";

            if($this->db->query($sql_group)) $pesan['tbl_group']='Table tbl_group Berhasil dibuat';
            else $pesan['tbl_group']='Table tbl_group Berhasil dibuat';

            if($this->db->query($sql_moduls)) $pesan['tbl_moduls']='Table tbl_moduls Berhasil dibuat';
            else $pesan['tbl_moduls']='Table tbl_moduls Berhasil dibuat';

            if($this->db->query($sql_moduls_group)) $pesan['sql_moduls_group']='Table sql_moduls_group Berhasil dibuat';
            else $pesan['sql_moduls_group']='Table sql_moduls_group Berhasil dibuat';

            if($this->db->query($sql_users)) $pesan['sql_users']='Table sql_users Berhasil dibuat';
            else $pesan['sql_users']='Table sql_users Berhasil dibuat';

            
            $controll_auth=$this->Generator_model->code_auth_controller();
            $models_general=$this->Generator_model->code_m_general();
            $view_login=$this->Generator_model->code_view_login();

            //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Auth.php', $controll_auth))
            {
                $pesan['controller_auth']= 'File ./application/controllers/Auth.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_auth']= 'File ./application/controllers/Auth.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/M_general.php', $models_general))
            {
                $pesan['m_general']= 'File ./application/views/m_general.php Gagal dibuat';
            }
            else
            {
                $pesan['m_general']= 'File ./application/models/M_general.php Berhasil dibuat';
            }

            //Membuat View List
            if ( ! write_file('./application/views/view_login.php', $view_login)){
                $pesan['view_login']= 'File ./application/views/view_login.php gagal dibuat';
            }
            else{
                $pesan['view_login']= 'File ./application/views/view_login.php berhasil dibuat';
            }

            $group_controller=$this->Generator_model->code_group_controller();
            $group_models=$this->Generator_model->code_group_models();
            $view_group_form=$this->Generator_model->code_group_form();
            $view_group_list=$this->Generator_model->code_group_form();
            $view_group_read=$this->Generator_model->code_group_form();
            $view_group_report=$this->Generator_model->code_group_form();
            $view_group_form=$this->Generator_model->code_group_form();
            $view_group_form=$this->Generator_model->code_group_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Group.php', $group_controller))
            {
                $pesan['controller_group']= 'File ./application/controllers/Group.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_group']= 'File ./application/controllers/Group.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Group_model.php', $group_models))
            {
                $pesan['models_group']= 'File ./application/models/Group_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_group']= 'File ./application/models/Group_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/Group';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Group Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Group/group_list.php', $view_group_list)){
                $pesan['view_group_list']= 'File ./application/views/Group/group_list.php gagal dibuat';
            }
            else{
                $pesan['view_group_list']= 'File ./application/views/Group/group_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Group/group_form.php', $view_group_form)){
                $pesan['view_group_form']= 'File ./application/views/Group/group_form.php gagal dibuat';
            }
            else{
                $pesan['view_group_form']= 'File ./application/views/Group/group_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Group/group_read.php', $view_group_read)){
                $pesan['view_group_read']= 'File ./application/views/Group/group_read.php gagal dibuat';
            }
            else{
                $pesan['view_group_read']= 'File ./application/views/Group/group_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Group/group_report.php', $view_group_report)){
                $pesan['view_group_report']= 'File ./application/views/Group/group_report.php gagal dibuat';
            }
            else{
                $pesan['view_group_report']= 'File ./application/views/Group/group_report.php berhasil dibuat';
            }


            $moduls_controller=$this->Generator_model->code_moduls_controller();
            $moduls_models=$this->Generator_model->code_moduls_models();
            $view_moduls_form=$this->Generator_model->code_moduls_form();
            $view_moduls_list=$this->Generator_model->code_moduls_form();
            $view_moduls_read=$this->Generator_model->code_moduls_form();
            $view_moduls_report=$this->Generator_model->code_moduls_form();
            $view_moduls_form=$this->Generator_model->code_moduls_form();
            $view_moduls_form=$this->Generator_model->code_moduls_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Moduls.php', $moduls_controller))
            {
                $pesan['controller_moduls']= 'File ./application/controllers/Moduls.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_moduls']= 'File ./application/controllers/Moduls.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Moduls_model.php', $moduls_models))
            {
                $pesan['models_moduls']= 'File ./application/models/Moduls_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_moduls']= 'File ./application/models/Moduls_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/moduls';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Moduls Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Moduls/moduls_list.php', $view_moduls_list)){
                $pesan['view_moduls_list']= 'File ./application/views/Moduls/moduls_list.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_list']= 'File ./application/views/Moduls/moduls_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Moduls/moduls_form.php', $view_moduls_form)){
                $pesan['view_moduls_form']= 'File ./application/views/Moduls/moduls_form.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_form']= 'File ./application/views/Moduls/moduls_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Moduls/moduls_read.php', $view_moduls_read)){
                $pesan['view_moduls_read']= 'File ./application/views/Moduls/moduls_read.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_read']= 'File ./application/views/Moduls/moduls_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Moduls/moduls_report.php', $view_moduls_report)){
                $pesan['view_moduls_report']= 'File ./application/views/Moduls/moduls_report.php gagal dibuat';
            }
            else{
                $pesan['view_moduls_report']= 'File ./application/views/Moduls/moduls_report.php berhasil dibuat';
            }


            $users_controller=$this->Generator_model->code_users_controller();
            $users_models=$this->Generator_model->code_users_models();
            $view_users_form=$this->Generator_model->code_users_form();
            $view_users_list=$this->Generator_model->code_users_form();
            $view_users_read=$this->Generator_model->code_users_form();
            $view_users_report=$this->Generator_model->code_users_form();
            $view_users_form=$this->Generator_model->code_users_form();
            $view_users_form=$this->Generator_model->code_users_form();

             //Membuat File controller/nama_controller.php
            if ( ! write_file('./application/controllers/Users.php', $users_controller))
            {
                $pesan['controller_users']= 'File ./application/controllers/Users.php Gagal Dibuat';
            }
            else
            {
                $pesan['controller_users']= 'File ./application/controllers/Users.php berhasil dibuat';
            }

            //Membuat File models/nama_models.php
            if ( ! write_file('./application/models/Users_model.php', $users_models))
            {
                $pesan['models_users']= 'File ./application/models/Users_model.php Gagal dibuat';
            }
            else
            {
                $pesan['models_users']= 'File ./application/models/Users_model.php Berhasil dibuat';
            }
            //Membuat FOlder do view
            $path='application/views/Users';
            if(!is_dir($path)) //create the folder if it's not already exists
            {
                mkdir($path,0755,TRUE);
                $pesan['path']= "Folder ./application/views/Users Berhasil dibuat";
            }

            //Membuat View List
            if ( ! write_file('./application/views/Users/users_list.php', $view_users_list)){
                $pesan['view_users_list']= 'File ./application/views/Users/users_list.php gagal dibuat';
            }
            else{
                $pesan['view_users_list']= 'File ./application/views/Users/users_list.php berhasil dibuat';
            }

            //Membuat View Form
            if ( ! write_file('./application/views/Users/users_form.php', $view_users_form)){
                $pesan['view_users_form']= 'File ./application/views/Users/users_form.php gagal dibuat';
            }
            else{
                $pesan['view_users_form']= 'File ./application/views/Users/users_form.php berhasil dibuat';
            }

            //Membuat View Read
            if ( ! write_file('./application/views/Users/users_read.php', $view_users_read)){
                $pesan['view_users_read']= 'File ./application/views/Users/users_read.php gagal dibuat';
            }
            else{
                $pesan['view_users_read']= 'File ./application/views/Users/users_read.php berhasil dibuat';
            }
            
            //Membuat View Report
            if ( ! write_file('./application/views/Users/users_report.php', $view_users_report)){
                $pesan['view_users_report']= 'File ./application/views/Users/users_report.php gagal dibuat';
            }
            else{
                $pesan['view_users_report']= 'File ./application/views/Users/users_report.php berhasil dibuat';
            }
        }

        
        //Membuat File config/pagination.php
        if ( ! write_file('./application/config/pagination.php', $string_pagination)){
            $error['paginasi']= 'File ./application/config/pagination.php Gagal Dibuat';
        }else
        {
            $pesan['paginasi']= 'File ./application/config/pagination.php Berhasil Dibuat';
        }

        //Membuat File controller/nama_controller.php
        if ( ! write_file('./application/controllers/' .$controller_name .'.php', $string_controller))
        {
            $error['controller']= 'File ./application/controllers/' .$controller_name .'.php Gagal Dibuat';
        }
        else
        {
            $pesan['controller']= 'File ./application/controllers/' .$controller_name .'.php berhasil dibuat';
        }

        //Membuat File models/nama_models.php
        if ( ! write_file('./application/models/' .$models_name .'.php', $string_models))
        {
            $error['models']= 'File ./application/models/' .$models_name .'.php Gagal dibuat';
        }
        else
        {
            $pesan['models']= 'File ./application/models/' .$models_name .'.php Berhasil dibuat';
        }
        //Membuat FOlder do view
        $path='application/views/' .$controller_name;
        if(!is_dir($path)) //create the folder if it's not already exists
        {
            mkdir($path,0755,TRUE);
            $pesan['path']= "Folder ./application/views/$controller_name Berhasil dibuat";
        }else{
            $error['path']= "Gagal Membuat folder ./application/views/$controller_name ";
        }

        //Membuat View List
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_list .'.php', $string_view_list)){
            $error['view_list']= 'File ./application/views/' .$view_list .'.php gagal dibuat';
        }
        else{
            $pesan['view_list']= 'File ./application/views/' .$view_list .'.php berhasil dibuat';
        }

        //Membuat View Form
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_form .'.php', $string_view_form)){
            $error['view_form']= 'File ./application/views/' .$view_form .'.php gagal dibuat';
        }
        else{
            $pesan['view_form']= 'File ./application/views/' .$view_form .'.php berhasil dibuat';
        }

        //Membuat View Read
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_read .'.php', $string_view_read)){
            $error['view_read']= 'File ./application/views/' .$view_read .'.php gagal dibuat';
        }
        else{
            $pesan['view_read']= 'File ./application/views/' .$view_read .'.php berhasil dibuat';
        }
        
        //Membuat View Report
        if ( ! write_file('./application/views/' .$controller_name .'/' .$view_report .'.php', $string_view_report)){
            $error['view_report']= 'File ./application/views/' .$view_report .'.php gagal dibuat';
        }
        else{
            $pesan['view_report']= 'File ./application/views/' .$view_report .'.php berhasil dibuat';
        }

        $this->session->set_flashdata('error', $error);
        $this->session->set_flashdata('message', $pesan);
        redirect(site_url('crud_generator/index?tabel=' .$table_name));
        }
    }

}

/* End of file Crud Generator.php */
/* Location: ./application/controllers/crud_generator.php */
/* Please DO NOT modify this information : */